<div class="checkout-page">
  <div class="checkout-container">
    <h1 class="checkout-title">Checkout</h1>

    @if (cartItems.length === 0) {
      <div class="empty-cart">
        <p>Your cart is empty</p>
        <a routerLink="/products" class="btn-secondary">Continue Shopping</a>
      </div>
    } @else {
      <div class="checkout-content">
        <!-- Shipping Information -->
        <div class="shipping-section card">
          <div class="section-header">
            <p class="section-kicker">Step 1</p>
            <h2>Shipping Information</h2>
            <p class="section-subtitle">Tell us where to send your order</p>
          </div>
          <form class="shipping-form">
            <div class="form-group">
              <label for="fullName">Full Name *</label>
              <input
                type="text"
                id="fullName"
                [value]="shippingForm().fullName"
                (input)="updateShippingField('fullName', $any($event.target).value)"
                placeholder="John Doe"
                required
              />
            </div>

            <div class="form-group">
              <label for="address1">Address Line 1 *</label>
              <input
                type="text"
                id="address1"
                [value]="shippingForm().address1"
                (input)="updateShippingField('address1', $any($event.target).value)"
                placeholder="123 Main St"
                required
              />
            </div>

            <div class="form-group">
              <label for="address2">Address Line 2</label>
              <input
                type="text"
                id="address2"
                [value]="shippingForm().address2"
                (input)="updateShippingField('address2', $any($event.target).value)"
                placeholder="Apt 4B (optional)"
              />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="city">City *</label>
                <input
                  type="text"
                  id="city"
                  [value]="shippingForm().city"
                  (input)="updateShippingField('city', $any($event.target).value)"
                  placeholder="New York"
                  required
                />
              </div>

              <div class="form-group">
                <label for="state">State *</label>
                <input
                  type="text"
                  id="state"
                  [value]="shippingForm().state"
                  (input)="updateShippingField('state', $any($event.target).value)"
                  placeholder="NY"
                  required
                />
              </div>

              <div class="form-group">
                <label for="zipCode">Zip Code *</label>
                <input
                  type="text"
                  id="zipCode"
                  [value]="shippingForm().zipCode"
                  (input)="updateShippingField('zipCode', $any($event.target).value)"
                  placeholder="10001"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label for="phone">Phone</label>
              <input
                type="tel"
                id="phone"
                [value]="shippingForm().phone"
                (input)="updateShippingField('phone', $any($event.target).value)"
                placeholder="(555) 123-4567 (optional)"
              />
            </div>
          </form>
        </div>

        <!-- Order Summary -->
        <div class="order-summary card">
          <div class="section-header">
            <p class="section-kicker">Step 2</p>
            <h2>Order Summary</h2>
            <p class="section-subtitle">Review items before placing your order</p>
          </div>
          <div class="summary-items">
            @for (item of cartItems; track item.id) {
              <div class="summary-item">
                <img [src]="item.imageUrl" [alt]="item.title" class="item-image">
                <div class="item-info">
                  <p class="item-name">{{ item.title }}</p>
                  <p class="item-qty">Qty: {{ item.quantity }}</p>
                </div>
                <p class="item-price">${{ (item.price * item.quantity).toFixed(2) }}</p>
              </div>
            }
          </div>

          <div class="summary-totals">
            <div class="total-row">
              <span>Subtotal:</span>
              <span>${{ cartTotals.subtotal.toFixed(2) }}</span>
            </div>
            <div class="total-row">
              <span>Tax:</span>
              <span>${{ cartTotals.tax.toFixed(2) }}</span>
            </div>
            <div class="total-row">
              <span>Shipping:</span>
              <span>${{ cartTotals.shipping.toFixed(2) }}</span>
            </div>
            <div class="total-row total-final">
              <span>Total:</span>
              <span>${{ cartTotals.total.toFixed(2) }}</span>
            </div>
          </div>
        </div>

        <!-- Checkout Actions -->
        <div class="checkout-actions">
          @if (errorMessage()) {
            <div class="error-message">{{ errorMessage() }}</div>
          }
          <button
            class="btn-complete-order"
            (click)="completeOrder()"
            [disabled]="processing()">
            @if (processing()) {
              <span>Processing...</span>
            } @else {
              <span>Complete Order (Demo)</span>
            }
          </button>
          <p class="demo-note">Demo Mode: This will create an order without payment processing</p>
        </div>
      </div>
    }
  </div>
</div>
