// Prisma Schema for Night Reader Sticker Shop
// Database: PostgreSQL

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// User model
model User {
  id           String   @id @default(uuid())
  email        String   @unique
  passwordHash String   @map("password_hash")
  name         String
  role         String   @default("user")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@map("users")
}

// Product model
model Product {
  id                String   @id @default(uuid())
  title             String
  subtitle          String?
  description       String
  price             Decimal  @db.Decimal(10, 2)
  salePrice         Decimal? @map("sale_price") @db.Decimal(10, 2)
  category          String
  collection        String
  tags              String[]
  badges            String[]
  rating            Decimal  @default(0) @db.Decimal(3, 2)
  reviewCount       Int      @default(0) @map("review_count")
  isNew             Boolean  @default(false) @map("is_new")
  isBestseller      Boolean  @default(false) @map("is_bestseller")
  isLimitedEdition  Boolean  @default(false) @map("is_limited_edition")
  stock             Int      @default(0)
  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @updatedAt @map("updated_at")

  images ProductImage[]

  @@map("products")
}

// Product images (separate table for normalization)
model ProductImage {
  id        String   @id @default(uuid())
  productId String   @map("product_id")
  url       String
  alt       String?
  isPrimary Boolean  @default(false) @map("is_primary")
  order     Int      @default(0)
  createdAt DateTime @default(now()) @map("created_at")

  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_images")
}
